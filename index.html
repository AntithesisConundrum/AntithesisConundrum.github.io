<!DOCTYPE html>
<html>	
	
	<head>
		
		<title>
			Rice GPA Calculator
		</title>
		
		<link href='https://fonts.googleapis.com/css?family=Lora' rel='stylesheet' type='text/css'>
		<link rel="icon" href="http://s12.postimg.org/uyisa178p/better_Icon.png">
		<script src="jquery.js"></script>
		
		<style>
			
			body {
			font-size: 20px;
			background-image: url("http://s30.postimg.org/b3x7j27gd/Owl.jpg");
			font-family: 'Lora', Georgia, 'Times New Roman';
			color: #5C2600;
			}
			
			header {
				text-align: center;
			}
			
			img {
				display: inline-block;
			}
			
			h1 {
				display: inline-block;
				text-align: center;
				margin: 0px 70px 0px 70px;
				font-size: 80px;
				position: relative;
				top: -40px;
			}
			
			h3 {
				margin: 0px 0px 10px 0px;
				text-align: center;
				position: relative;
				font-size: 130%;
			}
			
			h4 {
				font-size: 115%;
				text-align: center;
			}
			
			input {
				font-size: 22px;
				border: 3px solid #331700;
				margin: 7px;
				width: 80%;
				text-align: center;
				background-color: rgba(255, 255, 255, 0.6)
			}
			
			table {
				text-align: center;
				border: 3px solid #331700;
				width: 95%;
				position: absolute;
				left: 2.5%;
				border-collapse: collapse;
				margin-top: 1%;
			}
			
			td {
				border: 3px solid #331700;
				font-size: 20px;
			}

			.button {
				font-family: Verdana, Geneva, Tahoma, sans-serif;
				width: 15%;
				height: 5%;
				position: relative;
				margin: 5.25%;
				margin-top: 10%;
				margin-bottom: 3.5%;
				left: 11.5%;
				background-color: rgba(150, 0, 0, 0.1);
				border-radius: 5px;
			}
			
			footer {
				position: fixed;
				left: 5px;
				bottom: -5px;
			}
			
			p {
				font-size: 16px;
			}
			
			a {
				text-decoration: none;
				color: #002469;
			}
		</style>
		
	</head>
	
	<body>
		<header>
			<img src="http://grfx.cstv.com/schools/rice/graphics/rice-15-mast-r-logo-1280.png"> <h1>Rice GPA Calculator</h1> <img src="http://grfx.cstv.com/schools/rice/graphics/rice-15-mast-r-logo-1280.png">
		</header>
		<table>
			<tr>
				<td id="classname"><b>Class Name</b></td>
				<td id="numhours"><b>Number of Hours</b></td>
				<td id="letter"><b>Letter Grade</b></td>
			</tr>
			<tr>
				<span class="inputs">
					<td><input type="text" class="classes"></td>
					<td><input type="text" class="hours"></td>
					<td><input type="text" class="grade"></td>
				</span>
			</tr>
		</table>
		<br>
		<span class = "next"><input type="button" class="button" value="Next" /></span>
		<span class = "done"><input type="button" class="button" value="Done" /></span>
		<span class = "reset"><input type="button" class="button" value="Reset" /></span>
		<h4 class="entryMessage">Welcome! Start by entering information, then hitting "Next".</h4>
		<h3 class="classList"></h3>
		<h3 class="gpaAndErrors"></h3>
		
		<footer>
			<p> Created by <a href="mailto:clp9@rice.edu">Charles Paul</a> for CodeRed Liftoff, 2015 </p>
		</footer>
		
		<script>
			// These arrays will hold the inputted values
			// Equal indices correspond with each other
			var classes = [];
			var hours = [];
			var grades = [];
			
			// FUNCTION resetAnswers: resets the inputs
			var resetAnswers = function() {
				classes = [];
				hours = [];
				grades = [];
			}
			
			// When the text input field is being selected, resets its
			// value to be blank
			$('input:text').focus(
				function(){
					$(this).val('');
			});
			
			// FUNCTION recordAnswers: pushes the inputted values to
			// the correct arrays
			var recordAnswers = function() {
				// newHour needs to be a number
				newHour = Number($('.hours').val())
				if(isNaN(newHour)) {
					// Shows an error and stops the function
					$('.gpaAndErrors').show();
					$('.gpaAndErrors').html('"Hours" must be a number.')
					return null
				}
				// Course codes and grades should be uppercase
				newClass = $('.classes').val().toUpperCase()
				newGrade = $('.grade').val().toUpperCase()
				// If any of the fields are blank
				if(newClass == "" || newHour == "" || newGrade == "") {
					// Then it shows an error and stops the function
					$('.gpaAndErrors').show()
					$('.gpaAndErrors').html('You must fill out all fields.')
					return null
				}
				// Pushes the new values to the global arrays
				classes.push(newClass);
				hours.push(newHour);
				grades.push(newGrade);
			}
			
			// FUNCTION displayClasses: display all of the classes and the
			// associated data in a user-readable format
			var displayClasses = function() {
				var num = classes.length
				var index = 0
				var displayArray = []
				// For each index in [0, # of inputs)
				while(index < num) {
					// Take the index's value in each array
					currentClass = classes[index]
					currentHours = hours[index]
					currentGrade = grades[index]
					// Concencate them into one readable entry
					currentEntry = currentClass + " : " + currentHours + " Hours : " + currentGrade
					// The first element should just be the element
					if(index==0){
						displayArray.push(currentEntry)
					}
					// Every third element thereafter should start a new line
					else if(index % 3 == 0){
						displayArray.push("<br>")
						displayArray.push(currentEntry)
					}
					// And the others have breaks for ease of reading
					else{
						displayArray.push(" || " + currentEntry)
					}
					// Makes sure we're not stuck in an infinite loop
					index++
				}
				// Sets classList to the array of readable data
				$('.classList').html(displayArray)
			}
			
			// RESET BUTTON: resets arrays of inputs, shows the welcome message,
			// hides the other messages (They'd no longer apply)
			$('.reset').click(function() {
				$('.entryMessage').show();
				resetAnswers();
				$('.classList').hide();
				$('.gpaAndErrors').hide();
			});
			
			// NEXT BUTTON: Records Answers and Displays Classes
			$('.next').click(function() {
				$('.entryMessage').hide();
				$('.classList').show();
				$('.gpaAndErrors').hide();
				// Make sure these are below the .hide()s, or the error messages
				// will be hidden
				recordAnswers();
				//alert("recorded")
				displayClasses();
			});
			
			// ENTER KEY: Duplicates function of Next button on text inputs
			$(document).keypress(function(e) {
			if(e.which == 13) {
				$('.entryMessage').hide();
				$('.gpaAndErrors').hide();
				$('.classList').show();
				// Make sure these are below the .hide()s, or the error messages
				// will be hidden
				recordAnswers();
				displayClasses();
				}
			});
			
			// FUNCTION showResults: Either returns an error or the GPA
			var showResults = function() {
				//alert("Function")
				// Acts as the length for all arrays
				var numClasses = classes.length
				if(numClasses == 0) {
					return 'You must enter at least one class.'
				}
				var index  = 0
				var totalHours = 0
				var totalGrade = 0
				//alert("Beginning While")
				// For each element in each array with index in range
				// [0, # of input triples)
				while(index < numClasses){
					//alert("While")
					// currentHours needs to be a number
					var currentHours = Number(hours[index])
					if(isNaN(currentHours)) {
						return 'One of your "Hours" fields was entered improperly. Please reset and try again.'
					}
					// totalHours will eventually be sum(hours)
					// Sum's not a valid JS function
					totalHours += currentHours
					var currentGrade = grades[index];
					// totalGrade is the product of hours and grade
					// If possible, find way to iterate over these;
					// this many conditionals are prone to edge cases.
					if(currentGrade == "A+") {
						totalGrade += 4.3333*currentHours
					}
					else if(currentGrade == "A") {
						totalGrade += 4*currentHours
					}
					else if(currentGrade == "A-") {
						totalGrade += 3.6667*currentHours
					}
					else if(currentGrade == "B+") {
						totalGrade += 3.3333*currentHours
					}
					else if(currentGrade == "B") {
						totalGrade += 3*currentHours
					}
					else if(currentGrade == "B-") {
						totalGrade += 2.6667*currentHours
					}
					else if(currentGrade == "C+") {
						totalGrade += 2.3333*currentHours
					}
					else if(currentGrade == "C") {
						totalGrade += 2*currentHours
					}
					else if(currentGrade == "C-") {
						totalGrade += 1.6667*currentHours
					}
					else if(currentGrade == "D+") {
						totalGrade += 1.3333*currentHours
					}
					else if(currentGrade == "D") {
						totalGrade += 1*currentHours
					}
					else if(currentGrade == "D-") {
						totalGrade += 0.6667*currentHours
					}
					else if(currentGrade == "F") {
						totalGrade += 0
					}
					else {
						return 'One of your "Grade" fields was entered improperly. Please reset and try again.'
					}
				// Don't kill your browser; kill the loop!
				index++
				}
			//alert("GPA calc")
			// Calculate unrounded GPA
			var GPA = totalGrade / totalHours
			//alert("GPA good")
			// Calculate GPA to 3 decimal places
			var roundedGPA = Math.round(GPA*1000) / 1000
			//alert("round good")
			return("Your GPA is: " + roundedGPA)
			}
			
			// DONE BUTTON: shows the GPA (or error) produced by
			// calling showResults, and hides the entry message
			$('.done').click(function() {
				//alert("Done")
				var result = String(showResults());
				$('.gpaAndErrors').html(result);
				$('.entryMessage').hide();
				$('.gpaAndErrors').show();
			});
			
			// TO DO IF TIME PERMITS
			// Reset all text inputs after button press
			// Make the readable data more readable - table?
		</script>
	</body>
</html>
